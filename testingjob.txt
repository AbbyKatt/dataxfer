#Internal state management, BQ functions, and job management, workers, helpers etc

class TestingJob():

    def __init__(self,environment,component,keys_table,Table_Name, BL_Table_Name, Primary_Key, Aut_Compare_Flag, Columns_to_test, Exclude_Columns):
        self.Table_Name=Table_Name
        self.BL_Table_Name=BL_Table_Name
        self.Primary_Key=Primary_Key
        self.Aut_Compare_Flag=Aut_Compare_Flag
        self.Columns_to_test=Columns_to_test
        self.Exclude_Columns=Exclude_Columns
        
        #Information needed for the Batch
        self.environment=environment
        self.component=component
        self.keys_table=keys_table
        self.status="Queued"
        self.message=""

    #Dumps the test component to a string
    def DebugDump(self):
        print(f"""Table_Name={self.Table_Name}
        BL_Table_Name={self.BL_Table_Name}
        Primary_Key={self.Primary_Key}
        Aut_Compare_Flag={self.Aut_Compare_Flag}
        Columns_to_test={self.Columns_to_test}
        Exclude_Columns={self.Exclude_Columns}""")

    def SetStatus(self,status,message):
        self.status=status
        self.message=message

    def GetTestStatus(self):
        return {"Test_Name":self.BL_Table_Name,"Status":self.status,"Message":self.message}

    def Get_JSON(self):
        return f"""{{
            "Test_Name":"{self.BL_Table_Name}",
            "Status":"{self.status}",
            "Message":"{self.message}"
        }}""" 

